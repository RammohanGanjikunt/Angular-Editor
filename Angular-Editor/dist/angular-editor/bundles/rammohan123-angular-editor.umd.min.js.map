{"version":3,"sources":["../../../projects/angular-editor/src/lib/angular-editor.service.ts","../../../projects/angular-editor/src/lib/config.ts","../../../projects/angular-editor/src/lib/utils.ts","../../../projects/angular-editor/src/lib/angular-editor.component.ts","../../../node_modules/tslib/tslib.es6.js","../../../projects/angular-editor/src/lib/angular-editor-toolbar.component.ts","../../../projects/angular-editor/src/lib/ae-select/ae-select.component.ts","../../../projects/angular-editor/src/lib/angular-editor.module.ts"],"names":["AngularEditorService","http","doc","_this","this","saveSelection","getSelection","sel","getRangeAt","rangeCount","savedSelection","selectedText","toString","createRange","document","prototype","executeCommand","command","includes","execCommand","createLink","url","newUrl","insertHtml","insertColor","color","where","restoreSelection","setFontName","fontName","setFontSize","fontSize","html","Error","removeAllRanges","addRange","executeInNextQueueIteration","callbackFn","timeout","setTimeout","checkSelection","length","uploadImage","file","uploadData","FormData","append","name","post","uploadUrl","reportProgress","observe","withCredentials","uploadWithCredentials","insertImage","imageUrl","setDefaultParagraphSeparator","separator","createCustomClass","customClass","newTag","tagName","tag","class","insertVideo","videoUrl","match","insertYouTubeVideoTag","insertVimeoVideoTag","id","split","thumbnail","sub","get","subscribe","data","thumbnail_url_with_play_button","title","unsubscribe","nextNode","node","hasChildNodes","firstChild","nextSibling","parentNode","getRangeSelectedNodes","range","includePartiallySelectedContainers","startContainer","endNode","endContainer","rangeNodes","push","commonAncestorContainer","unshift","getSelectedNodes","nodes","i","len","apply","replaceWithOwnChildren","el","parent","insertBefore","removeChild","removeSelectedElements","tagNames","tagNamesArray","toLowerCase","forEach","nodeType","indexOf","Injectable","HttpClient","Inject","args","DOCUMENT","angularEditorConfig","editable","spellcheck","height","minHeight","maxHeight","width","minWidth","translate","enableToolbar","showToolbar","placeholder","defaultParagraphSeparator","defaultFontName","defaultFontSize","fonts","sanitize","toolbarPosition","outline","isDefined","value","AngularEditorComponent","r","editorService","sanitizer","cdRef","defaultTabIndex","autoFocus","modeVisual","showPlaceholder","disabled","focused","touched","changed","config","viewMode","EventEmitter","blurEvent","closeEvent","dataEvent","focusEvent","tabindex","parsedTabIndex","Number","tabIndex","onFocus","focus","ngOnChanges","changes","propName","index","firstChange","emit","showCaretPos","textArea","nativeElement","ngOnInit","ngAfterViewInit","toggleEditorMode","getCustomTags","onContentChange","exec","onTextAreaFocus","event","stopPropagation","configure","onTextAreaMouseOut","onTextAreaBlur","onTouched","relatedTarget","parentElement","classList","contains","getElementById","element","innerHTML","innerText","onChange","undefined","SecurityContext","HTML","togglePlaceholder","registerOnChange","fn","e","registerOnTouched","writeValue","refreshView","normalizedValue","setProperty","removeClass","editorWrapper","addClass","setDisabledState","isDisabled","div","action","bToSource","oContent","editableElement","createText","oPre","createElement","setStyle","oCode","appendChild","focusInstance","listen","blurInstance","querySelectorAll","selectNodeContents","editorToolbar","setEditorMode","userSelection","triggerButtons","a","focusNode","els","triggerBlocks","getFonts","map","x","label","tags","customClasses","join","ngOnDestroy","filterStyles","replace","getCaretCharacterOffsetWithin","caretOffset","ownerDocument","win","defaultView","parentWindow","preCaretRange","cloneRange","setEnd","endOffset","selection","type","textRange","preCaretTextRange","body","createTextRange","moveToElementText","setEndPoint","text","getCaretPosition","window","selectedObj","childNodes","anchorNode","textContent","startOffset","getAbsPosition","num","pos","count","htmlIndexes","findHTMLIndexes","state","j","start","end","htmlString","Component","selector","template","providers","provide","NG_VALUE_ACCESSOR","useExisting","forwardRef","multi","Renderer2","DomSanitizer","ChangeDetectorRef","Attribute","Input","Output","ViewChild","static","HostBinding","HostListener","Object","create","__values","o","s","Symbol","iterator","m","call","next","done","TypeError","AngularEditorToolbarComponent","er","htmlMode","linkSelected","block","headings","fontSizes","customClassId","customClassList","tagMap","BLOCKQUOTE","A","select","buttons","execute","defineProperty","classes","_customClasses","Boolean","triggerCommand","result","queryCommandState","elementById","findIndex","nodeName","found","y","find","Element","className","keys","foreColour","queryCommandValue","backColor","insertUrl","href","prompt","foreColor","toggleEditorModeButton","onFileChanged","target","files","upload","watchUploadImage","reader","FileReader","onload","fr","currentTarget","readAsDataURL","response","srcElement","setCustomClass","classId","isButtonHidden","hiddenButtons","Array","_b","_c","arr","item","console","log","ElementRef","AeSelectComponent","elRef","options","optionId","opened","hidden","changeEvent","selectedOption","hasOwnProperty","isHidden","hide","optionSelect","option","setValue","toggleOpen","onClick","$event","close","selectedEl","labelButton","handleKeyDown","key","_handleArrowDown","_handleArrowUp","_handleSpace","_handleEnter","_handleTab","preventDefault","_handleBackspace","encapsulation","ViewEncapsulation","None","NgModule","imports","CommonModule","FormsModule","ReactiveFormsModule","declarations","exports"],"mappings":"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","sourcesContent":["import {Inject, Injectable} from '@angular/core';\nimport {HttpClient, HttpEvent} from '@angular/common/http';\nimport {Observable} from 'rxjs';\nimport {DOCUMENT} from '@angular/common';\nimport {CustomClass} from './config';\n\nexport interface UploadResponse {\n  imageUrl: string;\n}\n\n@Injectable()\nexport class AngularEditorService {\n\n  savedSelection: Range | null;\n  selectedText: string;\n  uploadUrl: string;\n  uploadWithCredentials: boolean;\n\n  constructor(\n    private http: HttpClient,\n    @Inject(DOCUMENT) private doc: any\n  ) { }\n\n  /**\n   * Executed command from editor header buttons exclude toggleEditorMode\n   * @param command string from triggerCommand\n   */\n  executeCommand(command: string) {\n    const commands = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'pre'];\n    if (commands.includes(command)) {\n      this.doc.execCommand('formatBlock', false, command);\n      return;\n    }\n    this.doc.execCommand(command, false, null);\n  }\n\n  /**\n   * Create URL link\n   * @param url string from UI prompt\n   */\n  createLink(url: string) {\n    if (!url.includes('http')) {\n      this.doc.execCommand('createlink', false, url);\n    } else {\n      const newUrl = '<a href=\"' + url + '\" target=\"_blank\" external=\"true\">' + this.selectedText + '</a>';\n      this.insertHtml(newUrl);\n    }\n  }\n\n  /**\n   * insert color either font or background\n   *\n   * @param color color to be inserted\n   * @param where where the color has to be inserted either text/background\n   */\n  insertColor(color: string, where: string): void {\n    const restored = this.restoreSelection();\n    if (restored) {\n      if (where === 'textColor') {\n        this.doc.execCommand('foreColor', false, color);\n      } else {\n        this.doc.execCommand('hiliteColor', false, color);\n      }\n    }\n  }\n\n  /**\n   * Set font name\n   * @param fontName string\n   */\n  setFontName(fontName: string) {\n    this.doc.execCommand('fontName', false, fontName);\n  }\n\n  /**\n   * Set font size\n   * @param fontSize string\n   */\n  setFontSize(fontSize: string) {\n    this.doc.execCommand('fontSize', false, fontSize);\n  }\n\n  /**\n   * Create raw HTML\n   * @param html HTML string\n   */\n  insertHtml(html: string): void {\n\n    const isHTMLInserted = this.doc.execCommand('insertHTML', false, html);\n\n    if (!isHTMLInserted) {\n      throw new Error('Unable to perform the operation');\n    }\n  }\n\n  /**\n   * save selection when the editor is focussed out\n   */\n  public saveSelection = (): void => {\n    if (this.doc.getSelection) {\n      const sel = this.doc.getSelection();\n      if (sel.getRangeAt && sel.rangeCount) {\n        this.savedSelection = sel.getRangeAt(0);\n        this.selectedText = sel.toString();\n      }\n    } else if (this.doc.getSelection && this.doc.createRange) {\n      this.savedSelection = document.createRange();\n    } else {\n      this.savedSelection = null;\n    }\n  }\n\n  /**\n   * restore selection when the editor is focused in\n   *\n   * saved selection when the editor is focused out\n   */\n  restoreSelection(): boolean {\n    if (this.savedSelection) {\n      if (this.doc.getSelection) {\n        const sel = this.doc.getSelection();\n        sel.removeAllRanges();\n        sel.addRange(this.savedSelection);\n        return true;\n      } else if (this.doc.getSelection /*&& this.savedSelection.select*/) {\n        // this.savedSelection.select();\n        return true;\n      }\n    } else {\n      return false;\n    }\n  }\n\n  /**\n   * setTimeout used for execute 'saveSelection' method in next event loop iteration\n   */\n  public executeInNextQueueIteration(callbackFn: (...args: any[]) => any, timeout = 1e2): void {\n    setTimeout(callbackFn, timeout);\n  }\n\n  /** check any selection is made or not */\n  private checkSelection(): any {\n\n    const selectedText = this.savedSelection.toString();\n\n    if (selectedText.length === 0) {\n      throw new Error('No Selection Made');\n    }\n    return true;\n  }\n\n  /**\n   * Upload file to uploadUrl\n   * @param file The file\n   */\n  uploadImage(file: File): Observable<HttpEvent<UploadResponse>> {\n\n    const uploadData: FormData = new FormData();\n\n    uploadData.append('file', file, file.name);\n\n    return this.http.post<UploadResponse>(this.uploadUrl, uploadData, {\n      reportProgress: true,\n      observe: 'events',\n      withCredentials: this.uploadWithCredentials,\n    });\n  }\n\n  /**\n   * Insert image with Url\n   * @param imageUrl The imageUrl.\n   */\n  insertImage(imageUrl: string) {\n    this.doc.execCommand('insertImage', false, imageUrl);\n  }\n\n  setDefaultParagraphSeparator(separator: string) {\n    this.doc.execCommand('defaultParagraphSeparator', false, separator);\n  }\n\n  createCustomClass(customClass: CustomClass) {\n    let newTag = this.selectedText;\n    if (customClass) {\n      const tagName = customClass.tag ? customClass.tag : 'span';\n      newTag = '<' + tagName + ' class=\"' + customClass.class + '\">' + this.selectedText + '</' + tagName + '>';\n    }\n    this.insertHtml(newTag);\n  }\n\n  insertVideo(videoUrl: string) {\n    if (videoUrl.match('www.youtube.com')) {\n      this.insertYouTubeVideoTag(videoUrl);\n    }\n    if (videoUrl.match('vimeo.com')) {\n      this.insertVimeoVideoTag(videoUrl);\n    }\n  }\n\n  private insertYouTubeVideoTag(videoUrl: string): void {\n    const id = videoUrl.split('v=')[1];\n    const imageUrl = `https://img.youtube.com/vi/${id}/0.jpg`;\n    const thumbnail = `\n      <div style='position: relative'>\n        <img style='position: absolute; left:200px; top:140px'\n             src=\"https://img.icons8.com/color/96/000000/youtube-play.png\"/>\n        <a href='${videoUrl}' target='_blank'>\n          <img src=\"${imageUrl}\" alt=\"click to watch\"/>\n        </a>\n      </div>`;\n    this.insertHtml(thumbnail);\n  }\n\n  private insertVimeoVideoTag(videoUrl: string): void {\n    const sub = this.http.get<any>(`https://vimeo.com/api/oembed.json?url=${videoUrl}`).subscribe(data => {\n      const imageUrl = data.thumbnail_url_with_play_button;\n      const thumbnail = `<div>\n        <a href='${videoUrl}' target='_blank'>\n          <img src=\"${imageUrl}\" alt=\"${data.title}\"/>\n        </a>\n      </div>`;\n      this.insertHtml(thumbnail);\n      sub.unsubscribe();\n    });\n  }\n\n  nextNode(node) {\n    if (node.hasChildNodes()) {\n      return node.firstChild;\n    } else {\n      while (node && !node.nextSibling) {\n        node = node.parentNode;\n      }\n      if (!node) {\n        return null;\n      }\n      return node.nextSibling;\n    }\n  }\n\n  getRangeSelectedNodes(range, includePartiallySelectedContainers) {\n    let node = range.startContainer;\n    const endNode = range.endContainer;\n    let rangeNodes = [];\n\n    // Special case for a range that is contained within a single node\n    if (node === endNode) {\n      rangeNodes = [node];\n    } else {\n      // Iterate nodes until we hit the end container\n      while (node && node !== endNode) {\n        rangeNodes.push( node = this.nextNode(node) );\n      }\n\n      // Add partially selected nodes at the start of the range\n      node = range.startContainer;\n      while (node && node !== range.commonAncestorContainer) {\n        rangeNodes.unshift(node);\n        node = node.parentNode;\n      }\n    }\n\n    // Add ancestors of the range container, if required\n    if (includePartiallySelectedContainers) {\n      node = range.commonAncestorContainer;\n      while (node) {\n        rangeNodes.push(node);\n        node = node.parentNode;\n      }\n    }\n\n    return rangeNodes;\n  }\n\n  getSelectedNodes() {\n    const nodes = [];\n    if (this.doc.getSelection) {\n      const sel = this.doc.getSelection();\n      for (let i = 0, len = sel.rangeCount; i < len; ++i) {\n        nodes.push.apply(nodes, this.getRangeSelectedNodes(sel.getRangeAt(i), true));\n      }\n    }\n    return nodes;\n  }\n\n  replaceWithOwnChildren(el) {\n    const parent = el.parentNode;\n    while (el.hasChildNodes()) {\n      parent.insertBefore(el.firstChild, el);\n    }\n    parent.removeChild(el);\n  }\n\n  removeSelectedElements(tagNames) {\n    const tagNamesArray = tagNames.toLowerCase().split(',');\n    this.getSelectedNodes().forEach((node) => {\n      if (node.nodeType === 1 &&\n        tagNamesArray.indexOf(node.tagName.toLowerCase()) > -1) {\n        // Remove the node and replace it with its children\n        this.replaceWithOwnChildren(node);\n      }\n    });\n  }\n}\n","import { UploadResponse } from './angular-editor.service';\nimport { HttpEvent } from '@angular/common/http';\nimport { Observable } from 'rxjs';\n\nexport interface CustomClass {\n  name: string;\n  class: string;\n  tag?: string;\n}\n\nexport interface Font {\n  name: string;\n  class: string;\n}\n\nexport interface AngularEditorConfig {\n  editable?: boolean;\n  spellcheck?: boolean;\n  height?: 'auto' | string;\n  minHeight?: '0' | string;\n  maxHeight?: 'auto' | string;\n  width?: 'auto' | string;\n  minWidth?: '0' | string;\n  translate?: 'yes' | 'now' | string;\n  enableToolbar?: boolean;\n  showToolbar?: boolean;\n  placeholder?: string;\n  defaultParagraphSeparator?: string;\n  defaultFontName?: string;\n  defaultFontSize?: '1' | '2' | '3' | '4' | '5' | '6' | '7' | string;\n  uploadUrl?: string;\n  upload?: (file: File) => Observable<HttpEvent<UploadResponse>>;\n  uploadWithCredentials?: boolean;\n  fonts?: Font[];\n  customClasses?: CustomClass[];\n  sanitize?: boolean;\n  toolbarPosition?: 'top' | 'bottom';\n  outline?: boolean;\n  toolbarHiddenButtons?: string[][];\n}\n\nexport const angularEditorConfig: AngularEditorConfig = {\n  editable: true,\n  spellcheck: true,\n  height: 'auto',\n  minHeight: '0',\n  maxHeight: 'auto',\n  width: 'auto',\n  minWidth: '0',\n  translate: 'yes',\n  enableToolbar: true,\n  showToolbar: true,\n  placeholder: 'Enter text here...',\n  defaultParagraphSeparator: '',\n  defaultFontName: '',\n  defaultFontSize: '',\n  fonts: [\n    {class: 'arial', name: 'Arial'},\n    {class: 'times-new-roman', name: 'Times New Roman'},\n    {class: 'calibri', name: 'Calibri'},\n    {class: 'comic-sans-ms', name: 'Comic Sans MS'}\n  ],\n  uploadUrl: 'v1/image',\n  uploadWithCredentials: false,\n  sanitize: true,\n  toolbarPosition: 'top',\n  outline: true,\n  /*toolbarHiddenButtons: [\n    ['bold', 'italic', 'underline', 'strikeThrough', 'superscript', 'subscript'],\n    ['heading', 'fontName', 'fontSize', 'color'],\n    ['justifyLeft', 'justifyCenter', 'justifyRight', 'justifyFull', 'indent', 'outdent'],\n    ['cut', 'copy', 'delete', 'removeFormat', 'undo', 'redo'],\n    ['paragraph', 'blockquote', 'removeBlockquote', 'horizontalLine', 'orderedList', 'unorderedList'],\n    ['link', 'unlink', 'image', 'video']\n  ]*/\n};\n","export function isDefined(value: any) {\n  return value !== undefined && value !== null;\n}\n","import {\n  AfterViewInit,\n  Attribute,\n  ChangeDetectorRef,\n  Component,\n  ElementRef,\n  EventEmitter,\n  forwardRef,\n  HostBinding,\n  HostListener,\n  Inject,\n  Input,\n  OnChanges,\n  OnDestroy,\n  OnInit,\n  Output,\n  Renderer2,\n  SecurityContext,\n  SimpleChanges,\n  ViewChild\n} from '@angular/core';\nimport {ControlValueAccessor, NG_VALUE_ACCESSOR} from '@angular/forms';\nimport {AngularEditorConfig, angularEditorConfig} from './config';\nimport {AngularEditorToolbarComponent} from './angular-editor-toolbar.component';\nimport {AngularEditorService} from './angular-editor.service';\nimport {DOCUMENT} from '@angular/common';\nimport {DomSanitizer} from '@angular/platform-browser';\nimport {isDefined} from './utils';\n\n@Component({\n  selector: 'angular-editor',\n  templateUrl: './angular-editor.component.html',\n  styleUrls: ['./angular-editor.component.scss'],\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: forwardRef(() => AngularEditorComponent),\n      multi: true\n    },\n    AngularEditorService\n  ]\n})\nexport class AngularEditorComponent implements OnInit, ControlValueAccessor, AfterViewInit, OnDestroy, OnChanges {\n\n  private onChange: (value: string) => void;\n  private onTouched: () => void;\n\n  modeVisual = true;\n  showPlaceholder = false;\n  disabled = false;\n  focused = false;\n  touched = false;\n  changed = false;\n\n  focusInstance: any;\n  blurInstance: any;\n\n  @Input() id = '';\n  @Input() index : boolean;\n  @Input() config: AngularEditorConfig = angularEditorConfig;\n  @Input() placeholder = '';\n  @Input() tabIndex: number | null;\n\n  @Output() html;\n\n  @ViewChild('editor', {static: true}) textArea: ElementRef;\n  @ViewChild('editorWrapper', {static: true}) editorWrapper: ElementRef;\n  @ViewChild('editorToolbar') editorToolbar: AngularEditorToolbarComponent;\n\n  @Output() viewMode = new EventEmitter<boolean>();\n\n  /** emits `blur` event when focused out from the textarea */\n    // tslint:disable-next-line:no-output-native no-output-rename\n  @Output('blur') blurEvent: EventEmitter<FocusEvent> = new EventEmitter<FocusEvent>();\n  @Output('close') closeEvent: EventEmitter<any> = new EventEmitter<any>();\n  @Output('data') dataEvent: EventEmitter<any> = new EventEmitter<any>();\n\n  /** emits `focus` event when focused in to the textarea */\n    // tslint:disable-next-line:no-output-rename no-output-native\n  @Output('focus') focusEvent: EventEmitter<FocusEvent> = new EventEmitter<FocusEvent>();\n\n  @HostBinding('attr.tabindex') tabindex = -1;\n\n  @HostListener('focus')\n  onFocus() {\n    this.focus();\n  }\n\n  constructor(\n    private r: Renderer2,\n    private editorService: AngularEditorService,\n    @Inject(DOCUMENT) private doc: any,\n    private sanitizer: DomSanitizer,\n    private cdRef: ChangeDetectorRef,\n    @Attribute('tabindex') defaultTabIndex: string,\n    @Attribute('autofocus') private autoFocus: any\n  ) {\n    const parsedTabIndex = Number(defaultTabIndex);\n    this.tabIndex = (parsedTabIndex || parsedTabIndex === 0) ? parsedTabIndex : null;\n  }\n  ngOnChanges(changes: SimpleChanges): void {\n    for (const propName in changes) {\n      if (propName === 'index' && !changes.index.firstChange) {\n        this.dataEvent.emit(this.showCaretPos(this.textArea.nativeElement));\n      }\n\n    }\n  }\n\n  ngOnInit() {\n    this.config.toolbarPosition = this.config.toolbarPosition ? this.config.toolbarPosition : angularEditorConfig.toolbarPosition;\n  }\n\n  ngAfterViewInit() {\n    if (isDefined(this.autoFocus)) {\n      this.focus();\n    }\n  }\n\n  /**\n   * Executed command from editor header buttons\n   * @param command string from triggerCommand\n   */\n  executeCommand(command: string) {\n    this.focus();\n    if (command === 'focus') {\n      return;\n    }\n    if (command === 'toggleEditorMode') {\n      this.toggleEditorMode(this.modeVisual);\n    } else if (command !== '') {\n      if (command === 'clear') {\n        this.editorService.removeSelectedElements(this.getCustomTags());\n        this.onContentChange(this.textArea.nativeElement);\n      } else if (command === 'default') {\n        this.editorService.removeSelectedElements('h1,h2,h3,h4,h5,h6,p,pre');\n        this.onContentChange(this.textArea.nativeElement);\n      } else {\n        this.editorService.executeCommand(command);\n      }\n      this.exec();\n    }\n  }\n\n  /**\n   * focus event\n   */\n  onTextAreaFocus(event: FocusEvent): void {\n    if (this.focused) {\n      event.stopPropagation();\n      return;\n    }\n    this.focused = true;\n    this.focusEvent.emit(event);\n    if (!this.touched || !this.changed) {\n      this.editorService.executeInNextQueueIteration(() => {\n        this.configure();\n        this.touched = true;\n      });\n    }\n  }\n\n  /**\n   * @description fires when cursor leaves textarea\n   */\n  public onTextAreaMouseOut(event: MouseEvent): void {\n    this.editorService.saveSelection();\n  }\n\n  /**\n   * blur event\n   */\n  onTextAreaBlur(event: FocusEvent) {\n    /**\n     * save selection if focussed out\n     */\n    this.editorService.executeInNextQueueIteration(this.editorService.saveSelection);\n\n    if (typeof this.onTouched === 'function') {\n      this.onTouched();\n    }\n\n    if (event.relatedTarget !== null) {\n      const parent = (event.relatedTarget as HTMLElement).parentElement;\n      if (!parent.classList.contains('angular-editor-toolbar-set') && !parent.classList.contains('ae-picker')) {\n        this.blurEvent.emit(event);\n        this.focused = false;\n      }\n    }\n  }\n\n  /**\n   *  focus the text area when the editor is focused\n   */\n  focus() {\n    if (this.modeVisual) {\n      this.textArea.nativeElement.focus();\n    } else {\n      const sourceText = this.doc.getElementById('sourceText' + this.id);\n      sourceText.focus();\n      this.focused = true;\n    }\n  }\n\n  /**\n   * Executed from the contenteditable section while the input property changes\n   * @param element html element from contenteditable\n   */\n  onContentChange(element: HTMLElement): void {\n    let html = '';\n    if (this.modeVisual) {\n      html = element.innerHTML;\n    } else {\n      html = element.innerText;\n    }\n    if ((!html || html === '<br>')) {\n      html = '';\n    }\n    if (typeof this.onChange === 'function') {\n      this.onChange(this.config.sanitize || this.config.sanitize === undefined ?\n        this.sanitizer.sanitize(SecurityContext.HTML, html) : html);\n      if ((!html) !== this.showPlaceholder) {\n        this.togglePlaceholder(this.showPlaceholder);\n      }\n    }\n    this.changed = true;\n  }\n\n  /**\n   * Set the function to be called\n   * when the control receives a change event.\n   *\n   * @param fn a function\n   */\n  registerOnChange(fn: any): void {\n    this.onChange = e => (e === '<br>' ? fn('') : fn(e)) ;\n  }\n\n  /**\n   * Set the function to be called\n   * when the control receives a touch event.\n   *\n   * @param fn a function\n   */\n  registerOnTouched(fn: any): void {\n    this.onTouched = fn;\n  }\n\n  /**\n   * Write a new value to the element.\n   *\n   * @param value value to be executed when there is a change in contenteditable\n   */\n  writeValue(value: any): void {\n\n    if ((!value || value === '<br>' || value === '') !== this.showPlaceholder) {\n      this.togglePlaceholder(this.showPlaceholder);\n    }\n\n    if (value === undefined || value === '' || value === '<br>') {\n      value = null;\n    }\n\n    this.refreshView(value);\n  }\n\n  /**\n   * refresh view/HTML of the editor\n   *\n   * @param value html string from the editor\n   */\n  refreshView(value: string): void {\n    const normalizedValue = value === null ? '' : value;\n    this.r.setProperty(this.textArea.nativeElement, 'innerHTML', normalizedValue);\n\n    return;\n  }\n\n  /**\n   * toggles placeholder based on input string\n   *\n   * @param value A HTML string from the editor\n   */\n  togglePlaceholder(value: boolean): void {\n    if (!value) {\n      this.r.addClass(this.editorWrapper.nativeElement, 'show-placeholder');\n      this.showPlaceholder = true;\n\n    } else {\n      this.r.removeClass(this.editorWrapper.nativeElement, 'show-placeholder');\n      this.showPlaceholder = false;\n    }\n  }\n\n  /**\n   * Implements disabled state for this element\n   *\n   * @param isDisabled Disabled flag\n   */\n  setDisabledState(isDisabled: boolean): void {\n    const div = this.textArea.nativeElement;\n    const action = isDisabled ? 'addClass' : 'removeClass';\n    this.r[action](div, 'disabled');\n    this.disabled = isDisabled;\n  }\n\n  /**\n   * toggles editor mode based on bToSource bool\n   *\n   * @param bToSource A boolean value from the editor\n   */\n  toggleEditorMode(bToSource: boolean) {\n    let oContent: any;\n    const editableElement = this.textArea.nativeElement;\n\n    if (bToSource) {\n      oContent = this.r.createText(editableElement.innerHTML);\n      this.r.setProperty(editableElement, 'innerHTML', '');\n      this.r.setProperty(editableElement, 'contentEditable', false);\n\n      const oPre = this.r.createElement('pre');\n      this.r.setStyle(oPre, 'margin', '0');\n      this.r.setStyle(oPre, 'outline', 'none');\n\n      const oCode = this.r.createElement('code');\n      this.r.setProperty(oCode, 'id', 'sourceText' + this.id);\n      this.r.setStyle(oCode, 'display', 'block');\n      this.r.setStyle(oCode, 'white-space', 'pre-wrap');\n      this.r.setStyle(oCode, 'word-break', 'keep-all');\n      this.r.setStyle(oCode, 'outline', 'none');\n      this.r.setStyle(oCode, 'margin', '0');\n      this.r.setStyle(oCode, 'background-color', '#fff5b9');\n      this.r.setProperty(oCode, 'contentEditable', true);\n      this.r.appendChild(oCode, oContent);\n      this.focusInstance = this.r.listen(oCode, 'focus', (event) => this.onTextAreaFocus(event));\n      this.blurInstance = this.r.listen(oCode, 'blur', (event) => this.onTextAreaBlur(event));\n      this.r.appendChild(oPre, oCode);\n      this.r.appendChild(editableElement, oPre);\n\n      // ToDo move to service\n      this.doc.execCommand('defaultParagraphSeparator', false, 'div');\n\n      this.modeVisual = false;\n      this.viewMode.emit(false);\n      oCode.focus();\n    } else {\n      if (this.doc.querySelectorAll) {\n        this.r.setProperty(editableElement, 'innerHTML', editableElement.innerText);\n      } else {\n        oContent = this.doc.createRange();\n        oContent.selectNodeContents(editableElement.firstChild);\n        this.r.setProperty(editableElement, 'innerHTML', oContent.toString());\n      }\n      this.r.setProperty(editableElement, 'contentEditable', true);\n      this.modeVisual = true;\n      this.viewMode.emit(true);\n      this.onContentChange(editableElement);\n      editableElement.focus();\n    }\n    this.editorToolbar.setEditorMode(!this.modeVisual);\n  }\n\n  /**\n   * toggles editor buttons when cursor moved or positioning\n   *\n   * Send a node array from the contentEditable of the editor\n   */\n  exec() {\n    this.editorToolbar.triggerButtons();\n\n    let userSelection;\n    if (this.doc.getSelection) {\n      userSelection = this.doc.getSelection();\n      this.editorService.executeInNextQueueIteration(this.editorService.saveSelection);\n    }\n\n    let a = userSelection.focusNode;\n    const els = [];\n    while (a && a.id !== 'editor') {\n      els.unshift(a);\n      a = a.parentNode;\n    }\n    this.editorToolbar.triggerBlocks(els);\n  }\n\n  private configure() {\n    this.editorService.uploadUrl = this.config.uploadUrl;\n    this.editorService.uploadWithCredentials = this.config.uploadWithCredentials;\n    if (this.config.defaultParagraphSeparator) {\n      this.editorService.setDefaultParagraphSeparator(this.config.defaultParagraphSeparator);\n    }\n    if (this.config.defaultFontName) {\n      this.editorService.setFontName(this.config.defaultFontName);\n    }\n    if (this.config.defaultFontSize) {\n      this.editorService.setFontSize(this.config.defaultFontSize);\n    }\n  }\n\n  getFonts() {\n    const fonts = this.config.fonts ? this.config.fonts : angularEditorConfig.fonts;\n    return fonts.map(x => {\n      return {label: x.name, value: x.name};\n    });\n  }\n\n  getCustomTags() {\n    const tags = ['span'];\n    this.config.customClasses.forEach(x => {\n      if (x.tag !== undefined) {\n        if (!tags.includes(x.tag)) {\n          tags.push(x.tag);\n        }\n      }\n    });\n    return tags.join(',');\n  }\n\n  ngOnDestroy() {\n    this.closeEvent.emit(this.textArea.nativeElement.innerHTML)\n    if (this.blurInstance) {\n      this.blurInstance();\n    }\n    if (this.focusInstance) {\n      this.focusInstance();\n    }\n  }\n\n  filterStyles(html: string): string {\n    html = html.replace('position: fixed;', '');\n    return html;\n  }\n\n    /*\n    style=\"-webkit-user-select:text;\" is needed for iPad\n\n    */\n    getCaretCharacterOffsetWithin(element) {\n      var caretOffset = 0;\n      var doc = element.ownerDocument || element.document;\n      var win = doc.defaultView || doc.parentWindow;\n      var sel;\n      if (typeof win.getSelection != \"undefined\") {\n        sel = win.getSelection();\n        if (sel.rangeCount > 0) {\n          var range = win.getSelection().getRangeAt(0);\n          var preCaretRange = range.cloneRange();\n          preCaretRange.selectNodeContents(element);\n          preCaretRange.setEnd(range.endContainer, range.endOffset);\n          caretOffset = preCaretRange.toString().length;\n        }\n      } else if ((sel = doc.selection) && sel.type != \"Control\") {\n        var textRange = sel.createRange();\n        var preCaretTextRange = doc.body.createTextRange();\n        preCaretTextRange.moveToElementText(element);\n        preCaretTextRange.setEndPoint(\"EndToEnd\", textRange);\n        caretOffset = preCaretTextRange.text.length;\n      }\n      return caretOffset;\n    }\n\n    getCaretPosition(el) {\n      if (window.getSelection && window.getSelection().getRangeAt) {\n        var range = window.getSelection().getRangeAt(0);\n        var selectedObj = window.getSelection();\n        var rangeCount = 0;\n        var childNodes = selectedObj.anchorNode.parentNode.childNodes;\n        for (var i = 0; i < childNodes.length; i++) {\n          if (childNodes[i] == selectedObj.anchorNode) {\n            break;\n          }\n          if (childNodes[i]['outerHTML'])\n            rangeCount += childNodes[i]['outerHTML'].length;\n          else if (childNodes[i].nodeType == 3) {\n            rangeCount += childNodes[i].textContent.length;\n          }\n        }\n        return range.startOffset + rangeCount;\n      }\n      return -1;\n    }\n\n      showCaretPos(element) {\n        if(element){\n          return this.getAbsPosition(this.getCaretCharacterOffsetWithin(element),element);\n        }\n        return null;\n      }\n  getAbsPosition(num: number , element) {\n    let text =element.innerHTML;\n    let pos = 0;\n    let count = 0;\n    let htmlIndexes = this.findHTMLIndexes(text);\n      for (let index = 0; index < text.length; index++) {\n        let state = false;\n        for (let j = 0; j < htmlIndexes.length; j++) {\n          if(index >= htmlIndexes[j].start && index <= htmlIndexes[j].end){\n            state = true;\n            break;\n          }\n        }\n        if(state){\n          continue;\n        } else {\n          ++count;\n          if(count == num){\n            pos = index;\n            break;\n          }\n        }\n      }\n      return pos;\n  }\n  findHTMLIndexes(htmlString: string) {\n    let index = 0;\n    let htmlIndexes = [];\n    while (index < htmlString.length) {\n      let start = htmlString.indexOf('<', index);\n      if (start > -1) {\n        let end = htmlString.indexOf('>', start + 1)\n        htmlIndexes.push({\n          start: start,\n          end: end\n        })\n        index = end\n      } else {\n        index = htmlString.length\n      }\n    }\n    return htmlIndexes;\n  }\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import {Component, ElementRef, EventEmitter, Inject, Input, Output, Renderer2, ViewChild} from '@angular/core';\nimport {AngularEditorService, UploadResponse} from './angular-editor.service';\nimport {HttpResponse, HttpEvent} from '@angular/common/http';\nimport {DOCUMENT} from '@angular/common';\nimport {CustomClass} from './config';\nimport {SelectOption} from './ae-select/ae-select.component';\nimport { Observable } from 'rxjs';\n\n@Component({\n  selector: 'angular-editor-toolbar',\n  templateUrl: './angular-editor-toolbar.component.html',\n  styleUrls: ['./angular-editor-toolbar.component.scss'],\n})\n\nexport class AngularEditorToolbarComponent {\n  htmlMode = false;\n  linkSelected = false;\n  block = 'default';\n  fontName = 'Times New Roman';\n  fontSize = '3';\n  foreColour;\n  backColor;\n\n  headings: SelectOption[] = [\n    {\n      label: 'Heading 1',\n      value: 'h1',\n    },\n    {\n      label: 'Heading 2',\n      value: 'h2',\n    },\n    {\n      label: 'Heading 3',\n      value: 'h3',\n    },\n    {\n      label: 'Heading 4',\n      value: 'h4',\n    },\n    {\n      label: 'Heading 5',\n      value: 'h5',\n    },\n    {\n      label: 'Heading 6',\n      value: 'h6',\n    },\n    {\n      label: 'Heading 7',\n      value: 'h7',\n    },\n    {\n      label: 'Paragraph',\n      value: 'p',\n    },\n    {\n      label: 'Predefined',\n      value: 'pre'\n    },\n    {\n      label: 'Standard',\n      value: 'div'\n    },\n    {\n      label: 'default',\n      value: 'default'\n    }\n  ];\n\n  fontSizes: SelectOption[] = [\n    {\n      label: '1',\n      value: '1',\n    },\n    {\n      label: '2',\n      value: '2',\n    },\n    {\n      label: '3',\n      value: '3',\n    },\n    {\n      label: '4',\n      value: '4',\n    },\n    {\n      label: '5',\n      value: '5',\n    },\n    {\n      label: '6',\n      value: '6',\n    },\n    {\n      label: '7',\n      value: '7',\n    }\n  ];\n\n  customClassId = '-1';\n  // tslint:disable-next-line:variable-name\n  _customClasses: CustomClass[];\n  customClassList: SelectOption[] = [{label: '', value: ''}];\n  // uploadUrl: string;\n\n  tagMap = {\n    BLOCKQUOTE: 'indent',\n    A: 'link'\n  };\n\n  select = ['H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'P', 'PRE', 'DIV'];\n\n  buttons = ['bold', 'italic', 'underline', 'strikeThrough', 'subscript', 'superscript', 'justifyLeft', 'justifyCenter',\n    'justifyRight', 'justifyFull', 'indent', 'outdent', 'insertUnorderedList', 'insertOrderedList', 'link'];\n\n  @Input() id: string;\n  @Input() uploadUrl: string;\n  @Input() upload: (file: File) => Observable<HttpEvent<UploadResponse>>;\n  @Input() showToolbar: boolean;\n  @Input() fonts: SelectOption[] = [{label: '', value: ''}];\n\n  @Input()\n  set customClasses(classes: CustomClass[]) {\n    if (classes) {\n      this._customClasses = classes;\n      this.customClassList = this._customClasses.map((x, i) => ({label: x.name, value: i.toString()}));\n      this.customClassList.unshift({label: 'Clear Class', value: '-1'});\n    }\n  }\n\n  @Input()\n  set defaultFontName(value: string) {\n    if (value) {\n      this.fontName = value;\n    }\n  }\n\n  @Input()\n  set defaultFontSize(value: string) {\n    if (value) {\n      this.fontSize = value;\n    }\n  }\n\n  @Input() hiddenButtons: string[][];\n\n  @Output() execute: EventEmitter<string> = new EventEmitter<string>();\n\n  @ViewChild('fileInput', {static: true}) myInputFile: ElementRef;\n\n  public get isLinkButtonDisabled(): boolean {\n    return this.htmlMode || !Boolean(this.editorService.selectedText);\n  }\n\n  constructor(\n    private r: Renderer2,\n    private editorService: AngularEditorService,\n    private er: ElementRef,\n    @Inject(DOCUMENT) private doc: any\n  ) {\n  }\n\n  /**\n   * Trigger command from editor header buttons\n   * @param command string from toolbar buttons\n   */\n  triggerCommand(command: string) {\n    this.execute.emit(command);\n  }\n\n  /**\n   * highlight editor buttons when cursor moved or positioning\n   */\n  triggerButtons() {\n    if (!this.showToolbar) {\n      return;\n    }\n    this.buttons.forEach(e => {\n      const result = this.doc.queryCommandState(e);\n      const elementById = this.doc.getElementById(e + '-' + this.id);\n      if (result) {\n        this.r.addClass(elementById, 'active');\n      } else {\n        this.r.removeClass(elementById, 'active');\n      }\n    });\n  }\n\n  /**\n   * trigger highlight editor buttons when cursor moved or positioning in block\n   */\n  triggerBlocks(nodes: Node[]) {\n    if (!this.showToolbar) {\n      return;\n    }\n    this.linkSelected = nodes.findIndex(x => x.nodeName === 'A') > -1;\n    let found = false;\n    this.select.forEach(y => {\n      const node = nodes.find(x => x.nodeName === y);\n      if (node !== undefined && y === node.nodeName) {\n        if (found === false) {\n          this.block = node.nodeName.toLowerCase();\n          found = true;\n        }\n      } else if (found === false) {\n        this.block = 'default';\n      }\n    });\n\n    found = false;\n    if (this._customClasses) {\n      this._customClasses.forEach((y, index) => {\n        const node = nodes.find(x => {\n          if (x instanceof Element) {\n            return x.className === y.class;\n          }\n        });\n        if (node !== undefined) {\n          if (found === false) {\n            this.customClassId = index.toString();\n            found = true;\n          }\n        } else if (found === false) {\n          this.customClassId = '-1';\n        }\n      });\n    }\n\n    Object.keys(this.tagMap).map(e => {\n      const elementById = this.doc.getElementById(this.tagMap[e] + '-' + this.id);\n      const node = nodes.find(x => x.nodeName === e);\n      if (node !== undefined && e === node.nodeName) {\n        this.r.addClass(elementById, 'active');\n      } else {\n        this.r.removeClass(elementById, 'active');\n      }\n    });\n\n    this.foreColour = this.doc.queryCommandValue('ForeColor');\n    this.fontSize = this.doc.queryCommandValue('FontSize');\n    this.fontName = this.doc.queryCommandValue('FontName').replace(/\"/g, '');\n    this.backColor = this.doc.queryCommandValue('backColor');\n  }\n\n  /**\n   * insert URL link\n   */\n  insertUrl() {\n    let url = 'https:\\/\\/';\n    const selection = this.editorService.savedSelection;\n    if (selection && selection.commonAncestorContainer.parentElement.nodeName === 'A') {\n      const parent = selection.commonAncestorContainer.parentElement as HTMLAnchorElement;\n      if (parent.href !== '') {\n        url = parent.href;\n      }\n    }\n    url = prompt('Insert URL link', url);\n    if (url && url !== '' && url !== 'https://') {\n      this.editorService.createLink(url);\n    }\n  }\n\n  /**\n   * insert Video link\n   */\n  insertVideo() {\n    this.execute.emit('');\n    const url = prompt('Insert Video link', `https://`);\n    if (url && url !== '' && url !== `https://`) {\n      this.editorService.insertVideo(url);\n    }\n  }\n\n  /** insert color */\n  insertColor(color: string, where: string) {\n    this.editorService.insertColor(color, where);\n    this.execute.emit('');\n  }\n\n  /**\n   * set font Name/family\n   * @param foreColor string\n   */\n  setFontName(foreColor: string): void {\n    this.editorService.setFontName(foreColor);\n    this.execute.emit('');\n  }\n\n  /**\n   * set font Size\n   * @param fontSize string\n   */\n  setFontSize(fontSize: string): void {\n    this.editorService.setFontSize(fontSize);\n    this.execute.emit('');\n  }\n\n  /**\n   * toggle editor mode (WYSIWYG or SOURCE)\n   * @param m boolean\n   */\n  setEditorMode(m: boolean) {\n    const toggleEditorModeButton = this.doc.getElementById('toggleEditorMode' + '-' + this.id);\n    if (m) {\n      this.r.addClass(toggleEditorModeButton, 'active');\n    } else {\n      this.r.removeClass(toggleEditorModeButton, 'active');\n    }\n    this.htmlMode = m;\n  }\n\n  /**\n   * Upload image when file is selected.\n   */\n  onFileChanged(event) {\n    const file = event.target.files[0];\n    if (file.type.includes('image/')) {\n        if (this.upload) {\n          this.upload(file).subscribe(() => this.watchUploadImage);\n        } else if (this.uploadUrl) {\n            this.editorService.uploadImage(file).subscribe(() => this.watchUploadImage);\n        } else {\n          const reader = new FileReader();\n          reader.onload = (e: ProgressEvent) => {\n            const fr = e.currentTarget as FileReader;\n            this.editorService.insertImage(fr.result.toString());\n          };\n          reader.readAsDataURL(file);\n        }\n      }\n  }\n\n  watchUploadImage(response: HttpResponse<{imageUrl: string}>, event) {\n    const { imageUrl } = response.body;\n    this.editorService.insertImage(imageUrl);\n    event.srcElement.value = null;\n  }\n\n  /**\n   * Set custom class\n   */\n  setCustomClass(classId: string) {\n    if (classId === '-1') {\n      this.execute.emit('clear');\n    } else {\n      this.editorService.createCustomClass(this._customClasses[+classId]);\n    }\n  }\n\n  isButtonHidden(name: string): boolean {\n    if (!name) {\n      return false;\n    }\n    if (!(this.hiddenButtons instanceof Array)) {\n      return false;\n    }\n    let result: any;\n    for (const arr of this.hiddenButtons) {\n      if (arr instanceof Array) {\n        result = arr.find(item => item === name);\n      }\n      if (result) {\n        break;\n      }\n    }\n    return result !== undefined;\n  }\n\n  focus() {\n    this.execute.emit('focus');\n    console.log('focused');\n  }\n}\n","import {\n  Attribute,\n  Component,\n  ElementRef,\n  EventEmitter,\n  forwardRef, HostBinding,\n  HostListener,\n  Input,\n  OnInit,\n  Output,\n  Renderer2,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\nimport {ControlValueAccessor, NG_VALUE_ACCESSOR} from '@angular/forms';\nimport {isDefined} from '../utils';\n\nexport interface SelectOption {\n  label: string;\n  value: string;\n}\n\n@Component({\n  selector: 'ae-select',\n  templateUrl: './ae-select.component.html',\n  styleUrls: ['./ae-select.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: forwardRef(() => AeSelectComponent),\n      multi: true,\n    }\n  ]\n})\nexport class AeSelectComponent implements OnInit, ControlValueAccessor {\n  @Input() options: SelectOption[] = [];\n  // tslint:disable-next-line:no-input-rename\n  @Input('hidden') isHidden: boolean;\n\n  selectedOption: SelectOption;\n  disabled = false;\n  optionId = 0;\n\n  get label(): string {\n    return this.selectedOption && this.selectedOption.hasOwnProperty('label') ? this.selectedOption.label : 'Select';\n  }\n\n  opened = false;\n\n  get value(): string {\n    return this.selectedOption.value;\n  }\n\n  @HostBinding('style.display') hidden = 'inline-block';\n\n  // tslint:disable-next-line:no-output-native no-output-rename\n  @Output('change') changeEvent = new EventEmitter();\n\n  @ViewChild('labelButton', {static: true}) labelButton: ElementRef;\n\n  constructor(private elRef: ElementRef,\n              private r: Renderer2,\n  ) {}\n\n  ngOnInit() {\n    this.selectedOption = this.options[0];\n    if (isDefined(this.isHidden) && this.isHidden) {\n      this.hide();\n    }\n  }\n\n  hide() {\n    this.hidden = 'none';\n  }\n\n  optionSelect(option: SelectOption, event: MouseEvent) {\n\n    this.setValue(option.value);\n    this.onChange(this.selectedOption.value);\n    this.changeEvent.emit(this.selectedOption.value);\n    this.onTouched();\n    this.opened = false;\n    event.stopPropagation();\n   // this.toggleOpen(event)\n  }\n\n  toggleOpen(event: MouseEvent) {\n    // event.stopPropagation();\n    if (this.disabled) {\n      return;\n    }\n    this.opened = !this.opened;\n  }\n\n  @HostListener('document:click', ['$event'])\n  onClick($event: MouseEvent) {\n    if (!this.elRef.nativeElement.contains($event.target)) {\n      this.close();\n    }\n  }\n\n  close() {\n    this.opened = false;\n  }\n\n  get isOpen(): boolean {\n    return this.opened;\n  }\n\n  writeValue(value) {\n    if (!value || typeof value !== 'string') {\n      return;\n    }\n    this.setValue(value);\n  }\n\n  setValue(value) {\n    let index = 0;\n    const selectedEl = this.options.find((el, i) => {\n      index = i;\n      return el.value === value;\n    });\n    if (selectedEl) {\n      this.selectedOption = selectedEl;\n      this.optionId = index;\n    }\n  }\n\n  onChange: any = () => {\n  }\n  onTouched: any = () => {\n  }\n\n  registerOnChange(fn) {\n    this.onChange = fn;\n  }\n\n  registerOnTouched(fn) {\n    this.onTouched = fn;\n  }\n\n  setDisabledState(isDisabled: boolean): void {\n    this.labelButton.nativeElement.disabled = isDisabled;\n    const div = this.labelButton.nativeElement;\n    const action = isDisabled ? 'addClass' : 'removeClass';\n    this.r[action](div, 'disabled');\n    this.disabled = isDisabled;\n  }\n\n  @HostListener('keydown', ['$event'])\n  handleKeyDown($event: KeyboardEvent) {\n    if (!this.opened) {\n      return;\n    }\n    // console.log($event.key);\n    // if (KeyCode[$event.key]) {\n    switch ($event.key) {\n      case 'ArrowDown':\n        this._handleArrowDown($event);\n        break;\n      case 'ArrowUp':\n        this._handleArrowUp($event);\n        break;\n      case 'Space':\n        this._handleSpace($event);\n        break;\n      case 'Enter':\n        this._handleEnter($event);\n        break;\n      case 'Tab':\n        this._handleTab($event);\n        break;\n      case 'Escape':\n        this.close();\n        $event.preventDefault();\n        break;\n      case 'Backspace':\n        this._handleBackspace();\n        break;\n    }\n    // } else if ($event.key && $event.key.length === 1) {\n    // this._keyPress$.next($event.key.toLocaleLowerCase());\n    // }\n  }\n\n  _handleArrowDown($event) {\n    if (this.optionId < this.options.length - 1) {\n      this.optionId++;\n    }\n  }\n\n  _handleArrowUp($event) {\n    if (this.optionId >= 1) {\n      this.optionId--;\n    }\n  }\n\n  _handleSpace($event) {\n\n  }\n\n  _handleEnter($event) {\n    this.optionSelect(this.options[this.optionId], $event);\n  }\n\n  _handleTab($event) {\n\n  }\n\n  _handleBackspace() {\n\n  }\n}\n","import {NgModule} from '@angular/core';\nimport {AngularEditorComponent} from './angular-editor.component';\nimport {AngularEditorToolbarComponent} from './angular-editor-toolbar.component';\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms';\nimport {CommonModule} from '@angular/common';\nimport { AeSelectComponent } from './ae-select/ae-select.component';\n\n@NgModule({\n  imports: [\n    CommonModule, FormsModule, ReactiveFormsModule\n  ],\n  declarations: [AngularEditorComponent, AngularEditorToolbarComponent, AeSelectComponent],\n  exports: [AngularEditorComponent, AngularEditorToolbarComponent]\n})\nexport class AngularEditorModule {\n}\n"]}